{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página de Administración | Acceso Exitoso</title>
    <link rel="stylesheet" href="{% static 'manejo.css' %}">
</head>
<body>

    <header class="main-header">

        <nav class="nav-links">
            <a href="{% url 'index' %}" class="nav-link">Volver al Inicio</a>
            <!-- Aquí puedes añadir más opciones centradas -->
        </nav>

        <div class="user-session">
            <span class="username">Admin: {{ usuario.nombre }} {{ usuario.apellido }}</span>
        </div>
    </header>

    <main class="tabla-container">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h1 class="titulo">Gestión de Usuarios</h1>
            <div>
                <a href="{% url 'usuarios_contribuyentes' %}" class="btn" style="background:#2b7; color:#fff; padding:8px 12px; border-radius:6px; text-decoration:none;">Ver Usuarios y Contribuyentes</a>
            </div>
        </div>

        <!-- Barra de búsqueda: buscar por mail (texto) y filtrar por rol -->
        <div class="filtros" style="margin: 16px 0; display:flex; gap:8px; align-items:center;">
            <label for="searchMail">Buscar por correo:</label>
            <input id="searchMail" type="search" placeholder="Ingrese mail o parte del mail" style="padding:6px; width:300px;">

            <label for="filterRol" style="margin-left:12px;">Filtrar por rol:</label>
            <select id="filterRol" style="padding:6px;">
                <option value="all">Todos</option>
                <option value="cliente">cliente</option>
                <option value="administrador">administrador</option>
            </select>

            <button id="clearFilters" style="margin-left:8px; padding:6px;">Limpiar</button>
        </div>

        <table id="usuariosTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre Completo</th>
                    <th>Correo (Mail)</th>
                    <th>Rol</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for u in usuarios %}
                <tr>
                    <td>{{ u.id_usuario }}</td>
                    <td>{{ u.nombre }} {{ u.apellido }}</td>
                    <td class="cell-mail">{{ u.mail }}</td>
                    <td class="cell-rol">
                        {% if u.rol == 'administrador' %}
                            <strong>{{ u.rol }}</strong>
                        {% else %}
                            {{ u.rol }}
                        {% endif %}
                    </td>
                    <td>
                        <div class="action-buttons">
                            <a href="{% url 'editar' u.pk %}" class="btn-action btn-edit">Editar</a>
                            <a href="{% url 'eliminar' u.pk %}" class="btn-action btn-delete">Eliminar</a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </main>

    <script src="{% static 'manejo.js' %}"></script>

    <footer class="footer"></footer>

</body>
</html>